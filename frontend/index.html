<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UniFood Menu</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Moul&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<header>
    <div class="top-bar">
        <div class="logo-container">
            <img src="./images/logo.png" alt="UniFood Logo" class="logo">
        </div>
        <div class="top-nav">
            <nav class="top-nav">
                <a href="#">Очередь заказов</a>
                <a href="#">Акции</a>
                <a href="#">Вход</a>
            </nav>
        </div>
    </div>
    <hr class="separator">
    <div class="bottom-bar">
        <nav class="bottom-nav">
        </nav>
    </div>
  </header>
</body>
<script>
  function updateActiveSection() {
    console.log('Updating active section...');
    let current = '';
    document.querySelectorAll('.category').forEach(section => {
        const sectionTop = section.offsetTop;
        const sectionHeight = section.clientHeight;
        if (pageYOffset >= (sectionTop - sectionHeight / 3)) {
            current = section.getAttribute('id');
        }
    });

    document.querySelectorAll('.bottom-nav a').forEach(link => {
        link.classList.remove('active');
        if (link.getAttribute('href') === '#' + current) {
            link.classList.add('active');
        }
    });
}
fetch('http://localhost:8000/categories/products/')
  .then(response => response.json())
  .then(categories => {
    const navBar = document.querySelector('.bottom-nav');
    const content = document.querySelector('body');
    categories.forEach(category => {
      const link = document.createElement('a');
      link.href = `#${category.name}`;
      link.textContent = category.name;
      link.addEventListener('click', function() {
    document.querySelectorAll('.bottom-nav a').forEach(navLink => {
        navLink.classList.remove('active');
    });
    link.classList.add('active');
});
      navBar.appendChild(link);
      const categorySection = document.createElement('div');
      categorySection.classList.add('category');
      categorySection.innerHTML = `<h2>${category.name}</h2>`;
      categorySection.id = category.name;

      const productsDiv = document.createElement('div');
      productsDiv.classList.add('products');

      category.products.forEach(product => {
        const productCard = document.createElement('div');
        productCard.classList.add('card');
        productCard.innerHTML = `
          <div class="card-image">
            <img src='./images/Бургер.png'} alt="Изображение продукта">
          </div>
          <div class="card-rating">
            <span>${product.rating}</span>
            <img src="./images/pngwing 1.png" alt="Рейтинг">
          </div>
          <div class="card-content">
            <h3 class="dish-name">${product.name}</h3>
            ${product.weight ? `<p class="dish-weight">${product.weight}гр</p>` : ''}
          </div>
          <span class="dish-price">${product.price}</span>
          <button class="btn-add-to-cart">В корзину</button>
        `;
        productsDiv.appendChild(productCard);
      });

      categorySection.appendChild(productsDiv);
      content.appendChild(categorySection);
    });
    updateActiveSection();
  });
 window.addEventListener('scroll', updateActiveSection);
</script>

</html>
